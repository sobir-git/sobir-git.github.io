<!DOCTYPE html>
<html lang="en" id="top">
<head>
          <title>My Notes - Do my observations fit the model? Chi-square goodness of fit.</title>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="My Notes Full Atom Feed" />
        <link href="/feeds/probability-and-statistics.atom.xml" type="application/atom+xml" rel="alternate" title="My Notes Categories Atom Feed" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="/theme/css/rdark.css" />
        <link rel="stylesheet" type="text/css" href="/theme/css/relaunch.css" /><!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-8WVZ6PMB17"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-8WVZ6PMB17');
        </script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>






</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">My Notes</a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/category/misc.html">misc</a></li>
            <li class="active"><a href="/category/probability-and-statistics.html">probability and statistics</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="/do-my-observations-fit-the-model-chi-square-goodness-of-fit.html" rel="bookmark"
         title="Permalink to Do my observations fit the model? Chi-square goodness of fit.">Do my observations fit the model? Chi-square goodness of fit.</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2021-05-07T00:00:00+03:00">
      Fri 07 May 2021
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="/author/sobir-bobiev.html">Sobir Bobiev</a>
    </address>
    <div class="category">
        Category: <a href="/category/probability-and-statistics.html">probability and statistics</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Let <span class="math">\(X\)</span> be a categorial variable having <span class="math">\(r\)</span> different possible values. Let <span class="math">\(p_1, p_2, \ldots, p_r\)</span> be the probabilities of those categories, satisfying <span class="math">\(\sum_{i=1}^{r} p_i = 1\)</span>. Let <span class="math">\(\xi_n = [x_1, x_2, \ldots, x_n]\)</span> be a set of observations. Let's group the observations by their values: </p>
<div class="math">$$O = [O_1, O_2, \ldots, O_r], \quad \text{where } \sum_{i=0}^r O_i = n.$$</div>
<p>For such a value of <span class="math">\(n\)</span>, we can compute the <strong>expected</strong> number of observations in each category:
</p>
<div class="math">$$E_i = n p_i \quad \text{for } i = 1..r$$</div>
<p>Wait, not only we can compute the expected number in each category, we know exactly what distribution it has, namely, for <span class="math">\(i\)</span>-th category it is beta distribution <span class="math">\(B(n, p_i)\)</span>.</p>
<p>Now consider the expressions <span class="math">\(\frac{(O_i - E_i)^2}{E_i}\)</span>. In a way, they measure the amount of deviations the observations have from their expected values. <a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">Pearson</a> has established that the following test-statistic
</p>
<div class="math">$$
\chi^2 = \sum_{i=1}^r \frac{(O_i - E_i)^2}{E_i}
$$</div>
<p>
approaches Chi-square distribution with <span class="math">\(r-1\)</span> degrees of freedom.</p>
<p>Let's manipulate the expression a little bit and gain some intuition.
</p>
<div class="math">$$
\begin{split}
\chi^2 &amp;= \sum_{i=1}^r \frac{(O_i - E_i)^2}{E_i}
 = \sum_{i=1}^r \frac{(O_i - n p_i)^2}{n p_i} \\
&amp;= \sum_{i=1}^r \left(\frac{O_i - n p_i}{\sqrt{n p_i}}\right)^2 
 = \sum_{i=1}^r \left(\sqrt{1-p_i}\frac{O_i - n p_i}{\sqrt{n p_i (1-p_i)}} \right)^2 \\
&amp;= \sum_{i=1}^r (1-p_i)\left(\frac{O_i - n p_i}{\sqrt{n p_i (1-p_i)}} \right)^2 \\
&amp;= \sum_{i=1}^r (1-p_i)\left(\frac{O_i - E_i}{\sigma_i} \right)^2 
\end{split} \\
$$</div>
<p>
where <span class="math">\(\sigma_i^2\)</span> is the variance of counts in <span class="math">\(i\)</span>-th category (remember the formula for variance of binomial distribution). Note that the expressions under the square approximate a standard normal distribution (using the fact that binomial distribution approximates normal distribution for large enough values of <span class="math">\(n\)</span> and non-extreme values of <span class="math">\(p\)</span>). If we drop the coefficients <span class="math">\((1-p_i)\)</span> we would get something that <strong>approximates Chi-square distribution</strong> with <span class="math">\(n\)</span> degrees of freedom (remember that chi-square random variable arises from summing a number of independent standard normal random variables). Accounting for coefficients as well, which sum up to <span class="math">\(\sum(1-p_i) = r-1\)</span>, it's reasonable to accept that the degrees of freedom must be <span class="math">\(r-1\)</span>. <em>This is not a proof at all, rather a helpful intuitive reasoning.</em> To state it formally, once again
</p>
<div class="math">$$
\sum_{i=1}^r \frac{(O_i - E_i)^2}{E_i} \sim \chi^2(r-1)
$$</div>
<p>Back to our problem, now we have at least an establish test statistic that can help us know how much our observations differ from the mean. This test is famously known as <a href="https://en.wikipedia.org/wiki/Goodness_of_fit#Pearson's_chi-squared_test">Pearson's chi-squared test</a>.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div><!-- /.entry-content -->
</section>
        <a href="#top" class="js-scroll-top"> top </a> 
        <footer id="contentinfo" class="body">
            <address id="about" class="vcard body">
            Powered by <a href="https://getpelican.com/">Pelican</a>,
            Theme adapted from <a href="https://github.com/matuzo/matuzoat/">matuzo</a>.
            </address><!-- /#about -->
            <!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>